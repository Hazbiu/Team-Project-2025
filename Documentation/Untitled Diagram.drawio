<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36" version="28.2.8">
  <diagram name="Page-1" id="MtHnkJc-5eXT3cMtNGxS">
    <mxGraphModel dx="2765" dy="1643" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-26" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="vOUaW7Iaz5s-ezAFAJ3d-1" target="vOUaW7Iaz5s-ezAFAJ3d-15">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="515.2222222222222" y="659.333333333333" as="targetPoint" />
            <Array as="points">
              <mxPoint x="514" y="677" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-1" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=default;strokeColor=default;" vertex="1" parent="1">
          <mxGeometry x="70" y="-150" width="585" height="585" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="vOUaW7Iaz5s-ezAFAJ3d-4" target="vOUaW7Iaz5s-ezAFAJ3d-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-4" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="-495" y="-139" width="271" height="271" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-6" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;build.sh&lt;/b&gt;&lt;/font&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="265" y="-136" width="167" height="79" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-7" value="&lt;p class=&quot;MsoNormal&quot;&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Build primary_bootloader&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Build secondary_bootloader &lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Copy secondary_bootloader to secondary_bootloader.bin.&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Generate RoT keys (rot_private.pem, rot_public.pem).&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Generate bootloader keys (bl_private.pem, bl_public.pem).&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Sign secondary_bootloader.bin with RoT private key.&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Sign kernel_image.bin with bootloader private key.&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;rootfs.sh script is called&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;initramfs.sh script is called&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Package rootfs into ext4 image&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Sign the rootfs image&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Generate PKCS#7-signed metadata for dm-verity-signed&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;verity.sh script is called&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Launch in QEMU&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="171.5" y="-94" width="382" height="509" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-9" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;Linux Kernel&lt;/b&gt;&lt;/font&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-453" y="-125" width="174" height="53" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-11" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;kernel_image.bin gets created&lt;/font&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-52" y="-221" width="221" height="59" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-12" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;dm-verity signiture validation&lt;/font&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-468" y="-47" width="204" height="74" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-13" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=default;strokeColor=default;" vertex="1" parent="1">
          <mxGeometry x="946" y="-286" width="343" height="343" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-14" value="&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=default;strokeColor=default;" vertex="1" parent="1">
          <mxGeometry x="950" y="100" width="329" height="329" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-15" value="&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 14px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Create dm-verity hash tree&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Append it to the rootfs image&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Extract root hash and salt&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Generate and sign metadata file&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;aspect=fixed;fillColor=default;strokeColor=default;" vertex="1" parent="1">
          <mxGeometry x="946" y="511" width="331" height="331" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-16" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;rootfs.sh&lt;/b&gt;&lt;/font&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1046" y="-267" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-18" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;initramfs.sh&lt;/b&gt;&lt;/font&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1041" y="105" width="76" height="55" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-19" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;verity.sh&lt;/b&gt;&lt;/font&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1071" y="551" width="72.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-22" value="&lt;ul&gt;&lt;li&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Builds minimal rootfs(downloads from debioan webside)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Configure users which are allowed to enter the roots&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Mount essential filesystems for chroot&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="939.5" y="-242" width="344" height="271" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-23" value="&lt;ul&gt;&lt;li&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Build initramfs using gen_init_cpio&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Copy dmsetup and veritysetup if available&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Create minimal /init script&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Create initramfs_list.txt&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Generate CPIO archive&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font size=&quot;3&quot;&gt;Sign initramfs&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="962" y="166" width="333" height="158" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-24" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0.017;entryY=0.819;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="vOUaW7Iaz5s-ezAFAJ3d-1" target="vOUaW7Iaz5s-ezAFAJ3d-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-25" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0.012;entryY=0.572;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="vOUaW7Iaz5s-ezAFAJ3d-1" target="vOUaW7Iaz5s-ezAFAJ3d-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-28" value="2" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;strokeWidth=9;fontSize=26;" vertex="1" parent="1">
          <mxGeometry x="721" y="184" width="156" height="86" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-29" value="3" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;strokeWidth=9;fontSize=26;" vertex="1" parent="1">
          <mxGeometry x="721" y="573" width="156" height="86" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-30" value="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;strokeWidth=9;fontSize=26;" vertex="1" parent="1">
          <mxGeometry x="721" y="-117" width="156" height="86" as="geometry" />
        </mxCell>
        <mxCell id="vOUaW7Iaz5s-ezAFAJ3d-32" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="vOUaW7Iaz5s-ezAFAJ3d-1" target="vOUaW7Iaz5s-ezAFAJ3d-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
